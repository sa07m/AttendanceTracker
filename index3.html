<!DOCTYPE html>
<html>
<head>
  <title>Attendance Tracker</title>
  <style>
    .student {
      display: flex;
      align-items: center;
    }
    .tick {
      width: 20px;
      height: 20px;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <h1>Attendance Tracker</h1>

  <div>
    <label for="date">Date:</label>
    <input type="date" id="date">
    <button id="search">Search</button>
  </div>

  <div id="attendance-list">
    <!-- This will be populated with student names and radio buttons -->
  </div>

  <button id="mark-attendance">Mark Attendance</button>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/axios.min.js"></script>
  <script>
    document.getElementById("search").addEventListener("click", function() {
      const date = document.getElementById("date").value;
      // You can fetch student names from a database or an array
      const studentNames = ["Alice", "Bob", "Cindy", "David"];

      const attendanceList = document.getElementById("attendance-list");
      attendanceList.innerHTML = '';

      studentNames.forEach(name => {
        const studentDiv = document.createElement("div");
        studentDiv.className = "student";

        const label = document.createElement("label");
        label.textContent = name;

        const presentRadio = document.createElement("input");
        presentRadio.type = "radio";
        presentRadio.name = name;
        presentRadio.value = "Present";

        const absentRadio = document.createElement("input");
        absentRadio.type = "radio";
        absentRadio.name = name;
        absentRadio.value = "Absent";

        console.log(absentRadio.value)

        studentDiv.appendChild(label);
        studentDiv.appendChild(presentRadio);
        studentDiv.appendChild(absentRadio);
        attendanceList.appendChild(studentDiv);
      });
    });

    document.getElementById("mark-attendance").addEventListener("click", function() {
        const date = document.getElementById("date").value;
      const studentList = document.querySelectorAll(".student");
      studentList.forEach(student => {
        const name = student.querySelector("label").textContent;
        const presentRadio = student.querySelector("input[value='Present']");
        const absentRadio = student.querySelector("input[value='Absent']");

        // const tick = document.createElement("span");

        // if (presentRadio.checked) {
        //   tick.className = "tick";
        //   tick.textContent = "✔";
        //   tick.style.color = "green";
        // } else if (absentRadio.checked) {
        //   tick.className = "tick";
        //   tick.textContent = "✘";
        //   tick.style.color = "red";
        // }
        let status 
        if(presentRadio.checked) status='present'
        else status='absent'

        const obj={
            date,
            name,
            status        
        }
        console.log(obj)

        const addData = axios.post('http://localhost:7000/mark-attendance', obj)
        .then(result=>{
            console.log('in axios post')
            console.log(result.data)
            display(result.data)
        })
        .catch(err=>console.log(err))
        

        function display(obj){
            const tick = document.createElement("span");

        if (presentRadio.checked) {
          tick.className = "tick";
          tick.textContent = "✔";
          tick.style.color = "green";
        } else if (absentRadio.checked) {
          tick.className = "tick";
          tick.textContent = "✘";
          tick.style.color = "red";
        }
        student.appendChild(tick);
        // Remove the radio buttons after marking attendance
        student.removeChild(presentRadio);
        student.removeChild(absentRadio);
        }
      });

    });
  </script>
</body>
</html>
